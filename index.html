<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Mastermind - Ultimate Edition</title>
    <style>
        /* =========================================
           DA MASTERMIND - MODERN GLASSMORPHISM & NEON
        ========================================= */

        :root {
            --primary: #8b5cf6;
            /* Violet Neon */
            --secondary: #ec4899;
            /* Rose Neon */
            --bg-color: #0f172a;
            /* Bleu tr√®s fonc√© (Slate) */
            --glass-bg: rgba(30, 41, 59, 0.6);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Taches de lumi√®re en arri√®re-plan (Effet d'ambiance) */
        body::before,
        body::after {
            content: '';
            position: fixed;
            border-radius: 50%;
            filter: blur(100px);
            z-index: -1;
        }

        body::before {
            top: -10%;
            left: -10%;
            width: 50vw;
            height: 50vw;
            background: rgba(139, 92, 246, 0.2);
        }

        body::after {
            bottom: -10%;
            right: -10%;
            width: 50vw;
            height: 50vw;
            background: rgba(236, 72, 153, 0.15);
        }

        /* SYST√àME DE PAGES */
        .page {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 900px;
            padding: 10px 20px;
            animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .active {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* CARTES EN VERRE (Glassmorphism) */
        .card,
        .board-section,
        .rules-section {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            padding: 25px;
            border-radius: 24px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border);
            box-sizing: border-box;
        }

        .card {
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        /* TITRES DEGRAD√âS */
        h1 {
            background: linear-gradient(to right, #a855f7, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 20px;
            font-weight: 900;
            text-align: center;
        }

        /* INPUTS MODERNES */
        input {
            padding: 14px 20px;
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            width: 85%;
            margin: 8px 0;
            background: rgba(0, 0, 0, 0.2);
            color: white;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
            background: rgba(0, 0, 0, 0.4);
        }

        /* BOUTONS NEON */
        button {
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 99px;
            border: none;
            font-weight: bold;
            margin: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-p {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(236, 72, 153, 0.3);
        }

        .btn-p:hover:not(:disabled) {
            box-shadow: 0 6px 20px rgba(236, 72, 153, 0.6);
            transform: translateY(-2px);
        }

        .btn-s {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: white;
        }

        .btn-s:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        button:disabled {
            background: rgba(255, 255, 255, 0.05);
            color: #555;
            box-shadow: none;
            cursor: not-allowed;
            border: 1px solid transparent;
        }

        /* JEU & REGLES */
        .game-layout {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
        }

        .board-section {
            padding: 20px;
            flex-grow: 1;
            max-width: 450px;
        }

        .rules-section {
            max-width: 280px;
            text-align: left;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .rules-section h3 {
            color: white;
            margin-top: 0;
            font-weight: 600;
        }

        .rules-section ul {
            padding-left: 20px;
        }

        /* LE PLATEAU (Lignes √©pur√©es) */
        .ligne {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 99px;
            border: 1px solid rgba(255, 255, 255, 0.03);
            transition: 0.3s;
        }

        .ligne:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .pions-container {
            display: flex;
            gap: 8px;
        }

        .emp {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .bloc-ind {
            display: grid;
            gap: 4px;
            padding: 4px;
            border-radius: 8px;
        }

        .pt {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
        }

        /* PALETTE DE S√âLECTION */
        .palette {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 99px;
            border: 1px solid var(--glass-border);
        }

        .choix {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            cursor: pointer;
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .choix:hover {
            transform: scale(1.2);
        }

        /* COULEURS NEON (Glow effect) */
        .rouge,
        .bleu,
        .vert,
        .jaune,
        .orange,
        .violet {
            border: none !important;
        }

        .rouge {
            background: #ef4444;
            box-shadow: 0 0 12px rgba(239, 68, 68, 0.6);
        }

        .bleu {
            background: #3b82f6;
            box-shadow: 0 0 12px rgba(59, 130, 246, 0.6);
        }

        .vert {
            background: #10b981;
            box-shadow: 0 0 12px rgba(16, 185, 129, 0.6);
        }

        .jaune {
            background: #f59e0b;
            box-shadow: 0 0 12px rgba(245, 158, 11, 0.6);
        }

        .orange {
            background: #f97316;
            box-shadow: 0 0 12px rgba(249, 115, 22, 0.6);
        }

        .violet {
            background: #8b5cf6;
            box-shadow: 0 0 12px rgba(139, 92, 246, 0.6);
        }

        /* Indices */
        .noir {
            background: #000;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.8), inset 0 0 2px rgba(255, 255, 255, 0.3) !important;
            border: 1px solid #333;
        }

        .blanc {
            background: #fff;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.8) !important;
            border: none;
        }

        /* BARRE DE COMMENTAIRES */
        #barre-commentaires {
            margin-top: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            font-style: italic;
            text-align: center;
            color: var(--text-main);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        /* TABLEAUX SCORES */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        th {
            color: white;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--glass-border);
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        td {
            padding: 12px 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.02);
            color: var(--text-muted);
        }

        /* MODAL */
        #modal-fin {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.9);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(8px);
        }
    </style>
</head>

<body>

    <!-- PAGE 1: LOGIN -->
    <div id="p-login" class="page active">
        <h1>MASTERMIND</h1>
        <div class="card">
            <h3 style="margin-top:0; color:white; font-weight:600;">Connexion</h3>
            <input type="text" id="pseudo" placeholder="Votre Pseudo">
            <input type="password" id="mdp" placeholder="Votre Mot de passe">
            <br><br>
            <button class="btn-p" onclick="connexion()" style="width: 100%;">Jouer</button>
            <hr style="border-color: var(--glass-border); margin: 25px 0;">
            <button class="btn-s" onclick="jouerInvite()" style="width: 100%;">Mode Invit√©</button>
        </div>
    </div>

    <!-- PAGE 2: MENU -->
    <div id="p-menu" class="page">
        <h1 id="txt-bienvenue">Salut !</h1>
        <div class="card">
            <button class="btn-p" onclick="nav('p-mode')" style="width:100%; margin-bottom:10px;">Lancer une
                partie</button><br>
            <button class="btn-s" onclick="voirScores()" style="width:100%">Tableau des scores</button><br>
            <button onclick="location.reload()" class="btn-s"
                style="width:100%; margin-top: 25px; border:none; color:var(--text-muted);">Se d√©connecter</button>
        </div>
    </div>

    <!-- PAGE 3: MODE -->
    <div id="p-mode" class="page">
        <h1>Difficult√©</h1>
        <div class="card">
            <button class="btn-s" onclick="lancer(4)" style="width:100%; margin-bottom:15px;">Normal (4
                Pions)</button><br>
            <button class="btn-p"
                style="background:linear-gradient(135deg, #ef4444, #f97316); box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3); width:100%;"
                onclick="lancer(6)">HARDCORE (6 Pions)</button><br>
            <button onclick="nav('p-menu')" class="btn-s"
                style="border:none; color:var(--text-muted); margin-top:20px;">Retour</button>
        </div>
    </div>

    <!-- PAGE 4: JEU -->
    <div id="p-jeu" class="page" style="max-width: 950px;">
        <div
            style="display:flex; justify-content: space-between; align-items:center; width:100%; margin-bottom:20px; padding: 0 10px;">
            <span id="txt-mode"
                style="font-weight:600; color:var(--text-muted); font-size:1rem; text-transform:uppercase; letter-spacing:1px;">Mode:
                4</span>
            <span id="chrono" style="color:white; font-weight:bold; font-size: 1.5rem; letter-spacing:2px;">00:00</span>
            <button onclick="nav('p-menu')" class="btn-s"
                style="padding: 6px 12px; font-size: 0.8rem; margin:0;">Quitter</button>
        </div>

        <div class="game-layout">
            <!-- LE PLATEAU -->
            <div class="board-section">
                <div id="lignes-c"></div>
                <div class="palette" id="pal"></div>
                <div style="text-align: center; margin-top: 20px;">
                    <button id="btn-v" class="btn-p" onclick="valider()" disabled style="width:80%;">Valider la
                        Ligne</button>
                </div>
                <div id="barre-commentaires">Pr√™t √† jouer ? ‚ö°</div>
            </div>

            <!-- LES REGLES -->
            <div class="rules-section">
                <h3>Objectif</h3>
                <p>Trouver le code couleur secret en un maximum de 10 tentatives.</p>
                <h3 style="margin-top:25px;">Indices</h3>
                <ul style="list-style: none; padding: 0;">
                    <li
                        style="margin-bottom:12px; display:flex; align-items:center; gap:12px; background: rgba(0,0,0,0.2); padding:10px; border-radius:12px;">
                        <span class="pt noir"
                            style="display:inline-block; width:10px; height:10px; flex-shrink:0;"></span>
                        <span style="font-size:0.85rem; line-height:1.4;"><b>Noir</b><br>Bonne couleur & Bonne
                            place.</span>
                    </li>
                    <li
                        style="display:flex; align-items:center; gap:12px; background: rgba(0,0,0,0.2); padding:10px; border-radius:12px;">
                        <span class="pt blanc"
                            style="display:inline-block; width:10px; height:10px; flex-shrink:0;"></span>
                        <span style="font-size:0.85rem; line-height:1.4;"><b>Blanc</b><br>Bonne couleur mais Mauvaise
                            place.</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- PAGE 5: SCORES -->
    <div id="p-score" class="page">
        <h1>Leaderboard</h1>
        <div class="card" style="max-width: 600px;">
            <table id="table-scores">
                <thead>
                    <tr>
                        <th>Joueur</th>
                        <th>Mode</th>
                        <th>Essais</th>
                        <th>Temps</th>
                    </tr>
                </thead>
                <tbody id="corps-scores"></tbody>
            </table>
            <br>
            <button class="btn-s" onclick="nav('p-menu')" style="margin-top:15px; width:100%;">Retour au Menu</button>
        </div>
    </div>

    <!-- MODAL FIN DE JEU -->
    <div id="modal-fin">
        <div class="card">
            <h1 id="fin-titre" style="background:none; -webkit-text-fill-color:white; color:white;">FIN</h1>
            <p id="fin-desc" style="color:var(--text-muted); line-height:1.5;">R√©sum√©...</p>
            <div id="fin-secret"
                style="display:none; margin: 20px 0; padding: 15px; background: rgba(239, 68, 68, 0.1); border-radius: 12px; border: 1px solid rgba(239, 68, 68, 0.3);">
                <p style="color: #ef4444; font-weight: bold; margin:0 0 10px 0;">Le code secret √©tait :</p>
                <span id="secret-texte" style="color:white; font-size:1.1rem; letter-spacing:1px;"></span>
            </div>
            <br>
            <button class="btn-p" onclick="partagerEmail()" style="width:100%; margin-bottom:10px;">Partager mon
                score</button><br>
            <button class="btn-s" onclick="nav('p-menu'); document.getElementById('modal-fin').style.display='none';"
                style="width:100%; border:none;">Retour au Menu</button>
        </div>
    </div>

    <script>
        // Le code Javascript reste exactement le m√™me, aucune fonctionnalit√© n'est perdue !
        let utilisateurActuel = null;
        let config = { nb: 4, tours: 10 };
        let jeu = { code: [], essai: [], tour: 0, timer: null, debut: 0, gagne: false };
        const couleurs = ['rouge', 'bleu', 'vert', 'jaune', 'orange', 'violet'];

        const phrasesMotivation = [
            "C'est parti ! Analyse bien les premiers indices.",
            "Continue comme √ßa, affine ta recherche.",
            "Pas mal, on commence √† y voir clair.",
            "Concentre-toi, la logique fait le reste.",
            "Moiti√© du chemin. Chaque indice compte !",
            "Tu te rapproches, c'est s√ªr.",
            "Le moment de v√©rit√© approche.",
            "Avant-derni√®re chance ! R√©fl√©chis bien.",
            "Dernier essai ! C'est maintenant ou jamais !"
        ];

        function nav(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function jouerInvite() {
            utilisateurActuel = "Invit√©_" + Math.floor(Math.random() * 1000);
            document.getElementById('txt-bienvenue').innerText = "Bienvenue, " + utilisateurActuel;
            nav('p-menu');
        }

        function connexion() {
            const p = document.getElementById('pseudo').value.trim();
            const m = document.getElementById('mdp').value;
            if (!p || !m) return alert("Remplissez le pseudo et le mot de passe.");
            let comptes = JSON.parse(localStorage.getItem('m_comptes') || "{}");
            if (comptes[p]) {
                if (comptes[p] !== m) return alert("Mot de passe incorrect !");
            } else {
                comptes[p] = m;
                localStorage.setItem('m_comptes', JSON.stringify(comptes));
            }
            utilisateurActuel = p;
            document.getElementById('txt-bienvenue').innerText = "Salut, " + p;
            nav('p-menu');
        }

        function lancer(n) {
            config.nb = n;
            jeu.code = Array.from({ length: n }, () => couleurs[Math.floor(Math.random() * 6)]);
            jeu.essai = []; jeu.tour = 0; jeu.debut = 0; jeu.gagne = false;
            clearInterval(jeu.timer);
            document.getElementById('chrono').innerText = "00:00";
            document.getElementById('txt-mode').innerText = "Mode : " + (n == 6 ? 'HARDCORE' : 'NORMAL');

            const msgBar = document.getElementById('barre-commentaires');
            msgBar.innerText = "Pr√™t √† jouer ? ‚ö°";
            msgBar.style.borderLeftColor = "var(--primary)";

            const cont = document.getElementById('lignes-c');
            cont.innerHTML = "";
            for (let i = 0; i < 10; i++) {
                const l = document.createElement('div');
                l.className = 'ligne'; l.id = 't-' + i;
                let pions = '<div class="pions-container">';
                for (let j = 0; j < n; j++) pions += '<div class="emp"></div>';
                pions += '</div>';
                l.innerHTML = pions + `<div class="bloc-ind" style="grid-template-columns:repeat(${n == 6 ? 3 : 2},1fr)">${'<div class="pt"></div>'.repeat(n)}</div>`;
                cont.prepend(l);
            }

            document.getElementById('pal').innerHTML = couleurs.map(c => `<div class="choix ${c}" onclick="ajouter('${c}')"></div>`).join('');
            nav('p-jeu');
        }

        function ajouter(c) {
            if (jeu.debut === 0) {
                jeu.debut = Date.now();
                jeu.timer = setInterval(() => {
                    let s = Math.floor((Date.now() - jeu.debut) / 1000);
                    document.getElementById('chrono').innerText = Math.floor(s / 60).toString().padStart(2, '0') + ":" + (s % 60).toString().padStart(2, '0');
                }, 1000);
            }
            if (jeu.essai.length < config.nb) {
                jeu.essai.push(c);
                document.getElementById('t-' + jeu.tour).querySelectorAll('.emp')[jeu.essai.length - 1].className = 'emp ' + c;
            }
            document.getElementById('btn-v').disabled = jeu.essai.length !== config.nb;
        }

        function valider() {
            let n = 0, b = 0;
            let cS = [...jeu.code], cE = [...jeu.essai];
            for (let i = 0; i < config.nb; i++) if (cE[i] === cS[i]) { n++; cS[i] = null; cE[i] = null; }
            for (let i = 0; i < config.nb; i++) if (cE[i] && cS.includes(cE[i])) { b++; cS[cS.indexOf(cE[i])] = null; }

            const pts = document.getElementById('t-' + jeu.tour).querySelectorAll('.pt');
            for (let i = 0; i < n; i++) pts[i].className = 'pt noir';
            for (let i = 0; i < b; i++) pts[n + i].className = 'pt blanc';

            if (n === config.nb) {
                terminerPartie(true);
            } else if (jeu.tour === 9) {
                terminerPartie(false);
            } else {
                document.getElementById('barre-commentaires').innerText = phrasesMotivation[jeu.tour];
                jeu.tour++;
                jeu.essai = [];
                document.getElementById('btn-v').disabled = true;
            }
        }

        function terminerPartie(victoire) {
            clearInterval(jeu.timer);
            jeu.gagne = victoire;

            const msgBar = document.getElementById('barre-commentaires');
            document.getElementById('modal-fin').style.display = 'flex';

            const titre = document.getElementById('fin-titre');
            const desc = document.getElementById('fin-desc');
            const secInfo = document.getElementById('fin-secret');

            if (victoire) {
                msgBar.innerText = "Mission accomplie ! üéØ";
                msgBar.style.borderLeftColor = "#10b981";
                titre.innerText = "VICTOIRE !";
                titre.style.color = "#10b981";
                desc.innerText = `F√©licitations ${utilisateurActuel} !\nTu as crack√© le code en ${jeu.tour + 1} essai(s) et ${document.getElementById('chrono').innerText}.`;
                secInfo.style.display = "none";
                sauverScore();
            } else {
                msgBar.innerText = "Syst√®me verrouill√©. üîí";
                msgBar.style.borderLeftColor = "#ef4444";
                titre.innerText = "√âCHEC";
                titre.style.color = "#ef4444";
                desc.innerText = "Tu as √©puis√© tes 10 essais...";
                secInfo.style.display = "block";

                const dicoCol = { rouge: "Rouge", bleu: "Bleu", vert: "Vert", jaune: "Jaune", orange: "Orange", violet: "Violet" };
                document.getElementById('secret-texte').innerText = jeu.code.map(c => dicoCol[c]).join(' ‚Ä¢ ');
            }
        }

        function partagerEmail() {
            const sujet = encodeURIComponent(`Mon score au Mastermind (${utilisateurActuel})`);
            let corps = jeu.gagne
                ? `Salut !\n\nJe viens de gagner au Mastermind :\n- Mode : ${config.nb} pions\n- Essais : ${jeu.tour + 1}/10\n- Temps : ${document.getElementById('chrono').innerText}\n\nViens essayer de battre mon record !`
                : `Salut !\n\nJ'ai essay√© le Mastermind en mode ${config.nb} pions mais j'ai perdu...\nViens essayer de faire mieux que moi !`;
            window.location.href = `mailto:?subject=${sujet}&body=${encodeURIComponent(corps)}`;
        }

        function sauverScore() {
            if (utilisateurActuel.startsWith("Invit√©_")) return;
            let sc = JSON.parse(localStorage.getItem('m_scores') || "[]");
            sc.push({ pseudo: utilisateurActuel, mode: config.nb, essais: jeu.tour + 1, temps: document.getElementById('chrono').innerText, sec: Math.floor((Date.now() - jeu.debut) / 1000) });
            localStorage.setItem('m_scores', JSON.stringify(sc));
        }

        function voirScores() {
            let sc = JSON.parse(localStorage.getItem('m_scores') || "[]");
            sc.sort((a, b) => b.mode - a.mode || a.essais - b.essais || a.sec - b.sec);
            document.getElementById('corps-scores').innerHTML = sc.map(s => `<tr><td>${s.pseudo}</td><td>${s.mode === 6 ? 'HARD' : 'NORM'}</td><td>${s.essais}</td><td>${s.temps}</td></tr>`).join('');
            nav('p-score');
        }
    </script>
</body>

</html>